---
title: "Explicit Adaptation while Viewing the Hand"
output: html_notebook
---

```{r load_code, include=FALSE}
source('R/shared.R')
source('R/learningCurves.R')
source('R/noCursor.R')
source('R/localization.R')
```


# Overview

This document discusses figures and statistics for the Hand View project. Currently, figures and statistics are presented for learning curves and no cursor data. Statistics for Localization data will follow. 

A few things to note:
1) post-hoc tests used are supposed to be Tukey, but currently defaults to Sidak method. I will figure out how to switch this.
2) background information and interpretations between R chunks are currently a very rough draft. I will still come back and fix these write-ups

# Learning Curves

We aimed to determine the effects of explicit awareness of a visuomotor perturbation during reaching movements with a 30° CW rotation. 

Training reaches in *Cursor Trials* for both aligned and rotated sessions were manually inspected for failing to perform the required reach, e.g. not reaching the target with a smooth and straight movement. Trials that were not useable for further analyses were removed. For the remaining trials, we calculated angular deviation of the hand at the point of maximum velocity. This is the angular difference between a line connecting the home position to the target and a line connecting the home position to the participant's hand position at the peak of their movement velocity. Thus, in order to fully compensate for the cursor-rotation, participants had to deviate their reaches in the 30° CCW direction. We then calculated the difference between angular deviations in the first 90 trials of the rotated session and individual biases in reaches during the last 30 trials in the aligned session. This process was completed for every participant in each group.


## Show the data

Below is a plot of the angular deviation of the hand across the first 90 trials of the rotated session. Lines represent the mean angular deviation of each group in every trial, and corresponding shaded regions represent 95% Confidence Intervals. For a closer look, we also show the same data, but only for the first 20 and last 15 trials.

```{r plot_learningCurves}
plotLearningCurves(target='inline')
plotBlockedLearningCurves(target='inline')
```

We see that, during training, the Instructed Group countered the rotation immediately, while the other groups took longer (within 15-20 trials) to compensate for the cursor-rotation. The Cursor Jump group's rate of learning seems to suggest that they learn to compensate much faster than the Non-instructed, control group(i.e. the slope of the learning curve is steep). Lastly, all groups perform similar reaching movements at the end of training.

## ANOVAs

We aimed to analyze the effects of explicit knowledge of the visual perturbation on learning during the first 90 trials of training with a visuomotor rotation. To do this, we blocked the rotated training data into three sets. The first set consisted of the first three trials, the second consisted of the next three trials, and the third consisted of the last 15 trials of rotated training. We then investigated how the four groups and their performance during adaptation, compared with each other, for each of these three blocks. We performed a 3X4 mixed ANOVA with block as a within-subject factor (blocks 1, 2, and 3) and group as a between-subject factor (Non-instructed, Instructed, Cursor Jump, Hand View). All tests had alpha level set to 0.05 and, when necessary, Greenhouse Geisser corrections were applied.

```{r}
learningCurveANOVA()
```
We see that the main effects of group and block, and their interaction, were significant. This suggests that the rate of learning of at least one group differs from the other groups and that this difference depends on the block of trials. Hence, it is appropriate to look at differences between groups in each block. Particularly, we only look into the first 2 blocks, since it is observed from our plots that the groups do not differ in the last block.

## Post-hoc tests

We first display the means and 95% CI's for each group in each block. This table gives us an idea of which contrasts we want to test further. That is, if the mean of a group falls outside the confidence interval range of another group then the two groups must differ significantly from each other. For these contrasts, we use the Non-instructed group as a reference (since it is the control group) and compare all groups to it. We then compare all groups to the non-instructed group for blocks one and two, respectively. To control for multiplicity, we adjusted for p values using Tukey's HSD.

```{r}
learningcurveComparisonMeans()
```


```{r}
learningcurveComparisons(method='Tukey')
```

In comparing all groups to the Non-instructed group, regardless of block, only the Instructed group differed significantly. We observed the same conclusion when comparing all groups to the non-instructed group in block one. This suggests that only the instructed group had an initial advantage in learning to counter for the rotation of the cursor.In block two, however, only the cursor jump group significantly differed from the non-instructed group, suggesting that the cursor jump group learned to counter for the rotation of the cursor faster than the non-instructed group. The hand view group however,did not differ significantly from the non-instructed group, and hence did not show a similar rate of learning to the cursor jump group. It is important to note that when running the analyses without Tukey's HSD adjustment, we get almost similar conclusions. The only difference is that the instructed group will also differ significantly from the non-instructed group in block two.

To summarize, explicit knowledge of the perturbation has an effect on learning to adapt reaching movements when experiencing a visuomotor rotation. Particularly, being instructed on the nature of the perturbation and being given a strategy to counter it, creates an initial advantage in reducing hand direction error when reaching towards a target with a rotated cursor. However, explicit knowledge from experiencing different stimuli that show the mismatch between actual hand position and the cursor, does not produce a similar initial advantage.


# Reach aftereffects

Through the use of a process dissociation procedure (PDP) we investigated how explicit information affects participants' reaching movements when no cursor-feedback is presented.

Similar to the Learning Curves section, reaches in *No Cursor Trials* for both aligned and rotated sessions were manually inspected for failing to perform the required reach. Trials that were not useable for further analyses were removed. For the retained trials, we used the endpoint angle to calculate for the angular deviation of the hand. This is the angular difference between the point where the participant's hand movement ended and the target. We then subtracted mean angular deviations after training in the aligned session from those after training in the rotated session, in order to measure the effects of adaptation training on No Cursor reaches, i.e. reach aftereffects. To implement the PDP, we calculated mean angular deviations per participant when either including any strategy they learned during adaptation training or excluding such a strategy. Thus, awareness of learning about the visuomotor rotation would be associated with a difference between exclusion and inclusion trials, while lack of awareness will have no such difference between the two types of trials.

## Show the data

Below is a plot of the mean angular reach deviation of the hand for each group as a function of either excluding or including a strategy. Lines represent the mean angular deviation of each group, and corresponding shaded regions represent 95% Confidence Intervals.

```{r plot_noCursor}
plotGroupReachAfterEffects(target='inline')
```

We see from the figure that when including or excluding the strategy learned to counter the rotation, only the non-instructed group could not switch their strategy on or off at will. This suggests unawareness of learning for this group. Importantly, mean angular reach deviations for all groups in exclusive trials still deviated towards the direction of the rotation. This suggests that despite awareness of learning of the visuomotor rotation, implicit aftereffects were still present in all groups.

## Test for Reach Aftereffects

First, we test whether or not adaptation led to reach aftereffects. To do this, we compare the rotated no cursor trials to the aligned no cursor trials.Particularly, we use rotated no cursor trials where participants do not make use of a strategy. We perform a 2X4 mixed ANOVA with session (aligned or rotated) as a within-subject factor and group as a between-subject factor.

```{r}
NoCANOVA()
```

We see that there are implicit reach aftereffects after adaptation due to the significant main effect of session. However, since the interaction between group and session was also significant, it is possible that the effect of session is modulated by groups (i.e. the effect of session occurs for some groups but not the others). Thus, we run a post-hoc analysis comparing each group in one session to the other session.

```{r}
NoCursorComparisonMeans()
NoCursorComparisons(method = 'tukey')
```

Post-hoc analysis shows that the aligned and rotated sessions differed significantly for each group. Therefore, the possibility of the effect of session being modulated by groups is ruled out. (!!!Change this statement: We are unable to rule it out, because the hand view group could still be lower than the others. You might need to add a separate post-hoc test to see how it is modulated by groups).

## PDP-type analysis (Strategy Use)

After confirming that reach aftereffects are present in all groups, we test whether instructions or the presence of explicit stimuli brought about explicit learning. We run 2X4 mixed ANOVA with strategy use as a within-subject factor (with or without strategy) and group as a between-subject factor.

```{r}
RAEANOVA()
```

We see that the main effects of group and strategy, as well as their interaction are significant. This suggests that there is at least one group that differs in terms of angular reach deviations from the other groups, when using or not using a strategy. However, post-hoc tests are necessary to determine which of the groups differ.

```{r}
RAEComparisonMeans()
RAEComparisons(method = 'tukey')
```

The tests confirm our conclusions from the figure. All groups, except the non-instructed group, showed significantly different angular deviations when using a strategy. This suggests unawareness of learning in the non-instructed group.

# Localization

We also investigated how explicit awareness of the rotation during reaching movements affected participants' hand localization both before and after adaptation training.

Responses in *Active* and *Passive Localization* trials were manually inspected for localization deviations different from the majority of responses, such that responses fell more or less along a single arc across the workspace. To obtain estimates of hand location, we calculated the angular difference between the point where the participant's unseen hand movement ended and their response on the touchscreen, i.e. their perceived hand position. However, we encountered inconsistencies with some participants' touchscreen responses due to unintentional movement of the monitor, which presented the arc stimuli in both *Active* and *Passive Localization* trials. Thus, these inconsistencies confounded measures of angular difference. To account for this, we calculated a value for the mean squared error (MSE), where error was defined as the mismatch between coordinates for touchscreen responses and coordinates for the more stable robot/unseen hand position. To correct for the mismatch, we fitted the incorrect data into a circle and optimized it with the more stable data. From this corrected data, we removed touchscreen responses too far away from the arc centre (outliers defined as beyond ±20° from the arc centre) as well as removed outliers for measures of angular differences (beyond ±3 standard deviations from the mean angular difference).


As the points on the arc that participants move to differ and do not cover the entire workspace, we used a kernel smoothing method (width = 15°) to interpolate changes in hand localization at specific interpoints (50°, 90°, and 130°). These interpoints are the centre points of the arc stimuli presented to participants. We then used the means of these interpolated values to estimate shifts in hand localization. For each group, we calculated the difference between shifts in hand localization after training in the aligned session and from those after training in the rotated session. We then looked at shifts in hand localization based either only on proprioceptive information (measured in *Passive Localization* trials where participants did not have access to efference-based predictions) or on efference-based predictions (difference between *Passive Localization* and *Active Localization* trials).


## Show the data

Below is a plot of the mean angular shift in hand localization for each group as a function of the three interpoints (50°, 90°, and 130°). Panel 1 shows shifts in hand localization when both proprioceptive information and efference-based predictions are available to the participant. Panel 2 shows shifts in hand localization when only proprioceptive information is available. Panel 3 shows shifts in hand localization when efference-based predictions are isolated. Lines represent the mean angular shift in localization for each group, and corresponding shaded regions represent 95% Confidence Intervals.

```{r plot_localization}
plotLocalizationShift(target='inline')
```

We see from the figure that all groups showed a shift in hand localization, and that these shifts were larger when both efference-based predicitions and proprioceptive information was available to the participants (i.e., *Active Localization*). Moreover, in comparing Panels 2 and 3, we see that majority of the shifts in hand localization is accounted for by proprioceptive information. However, the lack of differences across groups show that awareness of the visuomotor rotation did not affect both proprioceptive recalibration and updating of predicted sensory consequences.

## ANOVA on ... active?

## ANOVA on passive?

## Predicted Sensory Consequences?
